(()=>{function e(e){return e&&e.__esModule?e.default:e}const t=(e,t,a)=>(...n)=>{try{e(...n)}catch(i){null==t||t(a||"Error in handler",i)}},a={1027:"Sponsored Display DRA"},n={1:"Enabled",0:"NotEnabled","-1":"Unknown"},i=e=>decodeURIComponent(escape(atob(e))),o=e=>e&&0===Object.keys(e).length&&e.constructor===Object;var s=function(e){return e.replace(/_/g,":")},r=/(\/b|\/s|\/l).*(node=)(\d{1,12})/,d=new Map,l=function(){if(!d.has(window.location.href)){var e=r.exec(window.location.href),t=e&&e[3]?e[3]:null;d.set(window.location.href,t)}return d.get(window.location.href)},c=function(e){var t=l();if(!e||!t)return null;var a=e.split(":");return a.splice(a.length-1,0,t),a.join(":")},m=function(e){var t=l();return t?"".concat(e,":").concat(t):null},p={wb:"ues",bb:"uet",af:"uet",cf:"uet",be:"uet",ld:"uex"},h=function(e){var t,a,n=e.latencyEvent,i=e.scope,o=e.placement,r=e.timestamp;u(n)&&(w(n,f(i),o.id,r),w(n,f(i),s(o.name),r),w(n,f(i),null!==(t=c(o.name))&&void 0!==t?t:void 0,r),w(n,f(i),null!==(a=m(o.id))&&void 0!==a?a:void 0,r))},u=function(e){return"function"==typeof window[p[e]]},w=function(e,t,a,n){void 0===n&&(n=new Date);var i=p[e];a&&"function"==typeof window[i]&&window[i](e,t+a,{wb:1},n)},f=function(e){return"adplacements:"+v(e)},v=function(e){return e?"".concat(e,":"):""},g=function(e,t,a){if(void 0===a&&(a=1),y()){var n=function(e,t,a){t&&S("".concat(A(e),":").concat(t),a)};n(e,t.id,a),n(e,m(t.id),a),n(e,s(t.name),a),n(e,c(s(t.name)),a)}},b=function(e,t){void 0===t&&(t=1),y()&&S(A(e),t)},y=function(){var e;return"function"==typeof(null===(e=null===window||void 0===window?void 0:window.ue)||void 0===e?void 0:e.count)},S=function(e,t){var a;return null===(a=null===window||void 0===window?void 0:window.ue)||void 0===a?void 0:a.count(e,t)},I="adplacements",A=function(e){return e.startsWith(I)?e:"".concat(I,":").concat(e)},M=function(e,t){E("ERROR",e,t)},D=function(e,t){E("FATAL",e,t)},E=function(e,t,a){console.error(t,T(t,a)),b("safeFrameError"),window.ueLogError&&window.ueLogError(T(t,a),{logLevel:e,attribution:"APE-safeframe",message:k(t,a)+" | "})},T=function(e,t){return t instanceof Error?t:t?new Error(t):new Error(e)},k=function(e,t){return t instanceof Error?e+": "+t.message:e},_=function(e,t,a){if(window.csa)try{window.csa("Content",{element:e})("mark",t,null==a?void 0:a.getTime())}catch(n){M("Error with 'mark' CSA",n)}};class L{sendLatencyMetric({latencyMetricType:e,placementId:t,placementName:a,placementDivId:n,timestamp:i}){h({latencyEvent:e.csmKey,scope:e.csmMessage,placement:{id:t,name:a},timestamp:i}),_(document.getElementById(n),e.csaKey,i)}}const x=()=>new L;var F=function(e,t,a){if(""===t)throw new Error("Invalid queryParamKey input to addJSONQueryParamToURL: "+JSON.stringify({queryParamKey:t}));var n=new URL(e),i=n.searchParams.get(t),o=i||"{}",s=JSON.parse(o),r=Object.assign(s,a);return n.searchParams.set(t,JSON.stringify(r)),n.toString()};function N(e,t,a){var n,i=a||{},o=i.noTrailing,s=void 0!==o&&o,r=i.noLeading,d=void 0!==r&&r,l=i.debounceMode,c=void 0===l?void 0:l,m=!1,p=0;function h(){n&&clearTimeout(n)}function u(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var r=this,l=Date.now()-p;function u(){p=Date.now(),t.apply(r,i)}function w(){n=void 0}m||(d||!c||n||u(),h(),void 0===c&&l>e?d?(p=Date.now(),s||(n=setTimeout(c?w:u,e))):u():!0!==s&&(n=setTimeout(c?w:u,void 0===c?e-l:e)))}return u.cancel=function(e){var t=(e||{}).upcomingOnly,a=void 0!==t&&t;h(),m=!a},u}const C="com.amazon.ads.cpp.",R=(e,t)=>`${C}${e}.${t}`;class z{*[Symbol.iterator](){for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e);if(null==t?void 0:t.startsWith(C)){const a=localStorage.getItem(t);if(localStorage.removeItem(t),e=-1,null===a)continue;yield[t,a]}}}}const H=(e,t,a)=>{localStorage.setItem(R(e,t),a)},W=e=>!e||O(e)||$(e)?e:e+"px",O=e=>e.length>1&&"%"===e.charAt(e.length-1),$=e=>e.length>2&&"px"===e.substring(e.length-2);class B{constructor(e,t){this.weblabsWindow=e,this.prefix=t,this.isT1=()=>"t1"===this.weblabTreatment(),this.isC=()=>"c"===this.weblabTreatment(),this.weblabTreatment=()=>{var e,t,a;return null===(a=null===(t=null===(e=this.weblabsWindow)||void 0===e?void 0:e.renderingWeblabs)||void 0===t?void 0:t[this.prefix])||void 0===a?void 0:a.toLowerCase()}}}const j=e=>["mobile-auto-top-advertising-0","auto-top-advertising-0"].includes(e)&&new B(window,"ADPT_SF_SPARKLE_838607").isT1(),V=e=>j(e.slotName)?e.renderingId:e.placementName,U=["allow-scripts","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation-by-user-activation"].concat(["allow-same-origin"]),q=(e,t,a)=>{const n=((e,t)=>{const a=document.createElement("iframe");return a.id=t,a.height=W(e.size.height)||"250px",a.width=W(e.size.width)||"300px",a.className=e.iframeClass||"",a.setAttribute("frameborder","0"),a.setAttribute("marginheight","0"),a.setAttribute("marginwidth","0"),a.setAttribute("scrolling","no"),a.setAttribute("allowtransparency","true"),a.setAttribute("data-arid",e.arid),a.style.cssText=e.iframeExtraStyle||"",a})(e,t);return n.src=a,n.sandbox=U.join(" "),n},J=(e,t)=>{var a,n;const i=e,s=i[t].options;if(o(i)||o(s))return null;const r=`ape_${V(s)}_iframe`;return i[t].iframe&&(i[t].iframe=(null===(n=null===(a=i[t])||void 0===a?void 0:a.iframe)||void 0===n?void 0:n.innerHTML)?i[t].iframe:document.getElementById(r)),i[t].iframe},Y=()=>window.innerHeight||document.documentElement.clientHeight,K=()=>window.innerWidth||document.documentElement.clientWidth,X=e=>e.getBoundingClientRect().top-Y(),G=(e,t)=>({t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height,z:t}),Q=e=>{const t=e.getBoundingClientRect();return G(t,Number(window.getComputedStyle(e,null).zIndex))},Z=e=>{const t=ie(e);return{t:e.t,l:e.l,r:e.r,b:e.b,w:e.w,h:e.h,z:e.z,xiv:t.xiv,yiv:t.yiv,iv:t.iv}},ee=()=>{const e=window.screenY?window.screenY:window.screenTop,t=window.screenX?window.screenX:window.screenLeft,a=K(),n=Y();return{t:e,l:t,w:a,h:n,b:e+n,r:t+a}},te=e=>{const t=ee(),a=(e=>Z(Q(e)))(e),n=oe(e);return{atf:ae(e),geom:{win:t,self:a,exp:n},payload:{wh:t.h,ww:t.w,sx:window.scrollX,sy:window.scrollY,ah:a.h,aw:a.w,top:a.t,left:a.l}}},ae=e=>{const t=function(e){const t=document.body.getBoundingClientRect();if(ne(t))return null;const a=Q(e),n=Y(),i=K(),o=Math.max(0,Math.min(t.left+i,a.r)-a.l),s=Math.max(0,Math.min(t.top+n,a.b)-a.t),r=o*s/(a.h*Math.min(a.w,i));return Number(Math.min(1,Math.max(0,r)).toFixed(2))}(e);return null==t?"unknown":t>=.5},ne=e=>0===e.width&&0===e.height;const ie=e=>{const t=K(),a=Y(),n=Math.max(0,de(e.t,e.b,a)),i=Math.max(0,de(e.l,e.r,t)),o=n*i,s=e.h*Math.min(e.w,t);return 0!==s||0!==o?{xiv:Number(Math.min(1,i/e.w).toFixed(2)),yiv:Number(Math.min(1,n/e.h).toFixed(2)),iv:Number(Math.min(1,Math.max(0,o/s)).toFixed(2))}:{xiv:0,yiv:0,iv:0}},oe=e=>{const t=e.getBoundingClientRect();return se(t)},se=e=>({t:e.top,l:e.left,r:K()-e.right,b:Y()-e.bottom,xs:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)>K()?1:0,yx:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)>Y()?1:0}),re=e=>se(e),de=(e,t,a)=>{let n=0;return"visible"!==document.visibilityState?n:(n=e>0?a-e:t>0?Math.min(t,a):0,Math.min(n,t-e))},le=(e,t)=>{const a=Q(e),n=Q(t),i=K(),o=Y();return a&&n&&(Math.abs(a.t-n.b)<o||Math.abs(a.b-n.t)<o)&&(Math.abs(a.l-n.r)<i||Math.abs(a.r-n.l)<i)},ce=e=>{const t=me(e),a=ee(),n=Z(G(t,NaN));return{atf:"unknown",geom:{win:a,self:n,exp:re(t)},payload:{wh:a.h,ww:a.w,sx:window.scrollX,sy:window.scrollY,ah:n.h,aw:n.w,top:n.t,left:n.l}}},me=e=>{const t=e.initialBoundingRect,a=t.top-(window.scrollY-e.originalScrollY),n=a+e.adHeight,i=t.left-(window.scrollX-e.originalScrollX);return{top:a,bottom:n,left:i,right:i+e.adWidth,width:e.adWidth,height:e.adHeight}},pe="localstorage_impression",he=(e,t)=>{const a=document.createElement("img");return a.id=e,a.style.display="none",a.setAttribute("pixel-url",t),a},ue="localstorage:impression",we=async(e,t)=>{let a,n;return new Promise((i=>{n=i,a=new IntersectionObserver((t=>{t.forEach((t=>{t.target===e&&t.isIntersecting&&(n(t),a.unobserve(e))}))}),t),a.observe(e)}))};var fe;fe=function(e){try{var t=window[e],a="__storage_test__";return t.setItem(a,a),t.removeItem(a),!0}catch(n){return!1}};const ve="sfImpression",ge="LightAdImpression",be="viewablelatency",ye=(e,t,a)=>({csaKey:e,csmKey:t,csmMessage:a}),Se=ye("bodyBegin","bb",ve),Ie=(ye("bodyBegin","bb",ge),ye("bodyEnd","be"),ye("clickToATF","af"),ye("criticalFeature","cf")),Ae=(ye("criticalFeature","cf",ve),ye("criticalFeature","cf",ge),ye("loaded","ld"),ye("loaded","ld",ve),ye("loaded","ld",ge),ye("viewablelatency:bodyBegin","bb",be),ye("viewablelatency:loaded","ld",be)),Me=e=>null==e?void 0:e.replace("criticalFeature","").replace("windowOnLoad","").replace("spATFEvent","").replace("r2OnLoad","").replace("aboveTheFold","").replace("af",""),De=e=>{const t=Me(e);return""===t||"immediate"===t},Ee=async(e,t)=>{e=Me(null!=e?e:"");const a="undefined"!=typeof P,n=/^reached(\d{1,5}px)FromTop$/g.exec(e);if(!De(e)){if(e.match("[^:]+:.+")){const t=e.split(":"),n=t[1],i=t.length>2?t[2]:n;if(a)return await new Promise((e=>P.when(i,"A").execute(e)));throw new Error("Need AUI or AmazonJQ installed")}return e.match(/^\d{1,4}px$/g)?await ke(parseInt(e,10),t,((e,t)=>{const a=X(e);return e&&a<=t})):n?await ke(parseInt(n[1],10),t,Te):void M(`Unknown delay pattern ${e}`)}},Te=(e,t)=>window.scrollY+Y()>=t,ke=async(e,a,n)=>new Promise((i=>{const o=()=>{n(a,e)&&(i(),window.removeEventListener("scroll",s),window.removeEventListener("resize",s))},s=t(N(20,(()=>{o()})),M);window.addEventListener("scroll",s),window.addEventListener("resize",s),o()})),Pe=(e,t,a,n,i)=>{var o;const s=(null===window||void 0===window?void 0:window.apeViewableLatencyTrackers)&&(null===(o=null===window||void 0===window?void 0:window.apeViewableLatencyTrackers)||void 0===o?void 0:o[e]);(null==s?void 0:s.valid)&&(s.loaded=!0,s.viewed&&(x().sendLatencyMetric({latencyMetricType:Ae,placementId:a,placementName:t,placementDivId:n,timestamp:new Date(i)}),g("htmlviewed:loaded",{id:a,name:t})))},_e=e=>{window.addEventListener("scroll",e),window.addEventListener("resize",e),document.addEventListener("visibilitychange",e)};var Le=function(e){if(window.csa)try{window.csa("Events",{producerId:"adplacements"})("setEntity",{adCreativeMetaData:e})}catch(t){M("Error with 'setEntity' CSA",t)}},xe=function(e,t,a){if(void 0===a&&(a=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e+":"+t.name+":"+t.id,metricValue:a},{ent:"all"})}catch(n){M("Error with 'logCsaEvent' CSA",n)}},Fe=function(e,t){if(void 0===t&&(t=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e,metricValue:t},{ent:"all"})}catch(a){M("Error with 'incrementCounter' CSA",a)}};const Ne=async(e,t,a,n)=>{a.options.firePixelsAfter&&await Ee(a.options.firePixelsAfter,a.placement),await He(t.adMap,a.options.arid),e.sendMessageToAd(a.options.arid,"fireImpression",n),Ce(e,t,a,n)},Ce=(e,t,a,n)=>{n.isNoInventory?ze(e,t,a):Re(e,t,a)},Re=(e,t,a)=>{We(e,t.adMap,a.options.arid);const n=t.ADS_HANDLERS[a.options.arid];n.viewabilityTracker=()=>{N(50,We)(e,t.adMap,a.options.arid)},_e(n.viewabilityTracker);new IntersectionObserver((()=>{We(e,t.adMap,a.options.arid)}),{threshold:[0,.5,1]}).observe(a.placement)},ze=(e,t,a)=>{const n=$e(t.adMap,a.options.arid);t.adMap[a.options.arid].noInventorySlotSnapshot=n,Oe(e,t.adMap,a.options.arid,n),e.sendMessageToAd(a.options.arid,"handleFallbackBehavior",{});const i=t.ADS_HANDLERS[a.options.arid];i.noInventoryViewabilityTracker=()=>{N(20,Oe)(e,t.adMap,a.options.arid,n)},_e(i.noInventoryViewabilityTracker)},He=async(e,t)=>{const a=J(e,t),n={root:document.documentElement};await we(a,n)},We=(e,t,a)=>{const n=t[a].options,i=J(t,a),o=n.viewabilityStandards;if(i){const t=te(i);t.viewabilityStandards=o,e.sendMessageToAd(a,"updateViewability",t)}},Oe=(e,t,a,n)=>{const i=t[a].options.viewabilityStandards,o=ce(n);o.viewabilityStandards=i,e.sendMessageToAd(a,"updateViewability",o)},$e=(e,t)=>{const a=J(e,t);return{initialBoundingRect:(n=a).getBoundingClientRect(),adHeight:n.offsetHeight,adWidth:n.offsetWidth,originalScrollX:window.scrollX,originalScrollY:window.scrollY};var n},Be=e=>{try{Ve(e,document.body),b(ue,1),Fe(pe)}catch(t){b("localstorage:error",1),Fe("localstorage_error")}},je=()=>{if(e(fe)("localStorage"))for(const e of new z){const t=e[1];Be(t)}},Ve=async(e,t)=>{const a=F(e,"pj",{measurementMethod:"cod_client"});try{await fetch(a,{keepalive:!0,mode:"no-cors"}),t.appendChild(he("ape_impression",a)),b(ue+"loaded"),Fe(pe+"loaded")}catch(n){throw b(ue+"error"),Fe(pe+"error"),n}b("impressionFired")};const Ue=(e,t)=>{for(const a of Object.keys(t))e.style[a]=t[a];return e},qe=(e,t,a,n,i,o)=>{var s;try{const r=Ke(e,o),d=Xe(e,o)||r,l=Ge(e,o);if(null===d||null===r||null===l)return void M("Unable to find wrapper, placement, or safe frame iframe",new Error("resizeSafeFrameAd error"));const c=O(a),m=O(t),p=!m&&!c,h=parseInt(t,10);let u=m?l.offsetWidth:h,w=c?l.offsetHeight:parseInt(a,10);const f=parseInt(n,10),v=e=>{p&&(w=Qe({height:w,width:u,targetWidth:e})),u=Math.round(e)},b=0===d.offsetWidth?K():d.offsetWidth;f&&Y()<K()?v(f):v(b);const y=null===(s=null==i?void 0:i.adMap[e])||void 0===s?void 0:s.noInventorySlotSnapshot;y&&(y.adHeight=w,y.adWidth=u);const S=W(u),I=W(p?w:a);if(l.style.height=I,l.style.width=S,d!==r){r.style.height=I;const t={width:S,height:I};i.sendMessageToAd(e,"resizeCreativeWrapper",t)}"Detail_hero-quick-promo_Desktop"===o[e].slotId&&(g("OffsetLeft",{id:i.adMap[e].options.placementId,name:o[e].slotId},l.offsetLeft),g("OffsetTop",{id:i.adMap[e].options.placementId,name:o[e].slotId},l.offsetTop),g("OffsetWidth",{id:i.adMap[e].options.placementId,name:o[e].slotId},l.offsetWidth),g("OffsetHeight",{id:i.adMap[e].options.placementId,name:o[e].slotId},l.offsetHeight))}catch(r){M("Error resizing ad: "+o[e].slotId,r)}},Je=(e,t,a)=>{const n=Xe(e,t)||Ke(e,t),i=Ge(e,t),o=a.resizePlacementStyleAboveThreshold,s=a.resizePlacementStyleBelowThreshold,r=parseInt(a.resizePlacementWidthThreshold,10);n&&i&&r&&o&&s?n.offsetWidth<r?Ue(i,s):Ue(i,o):M("Missing arguments in setResizePlacementStyle",new Error("setResizePlacementStyle error"))},Ye=(e,t,a)=>{const n=Ge(e,t);n.style.height=W(a),n.style.zIndex="2",n.style.position="relative"},Ke=(e,t)=>document.getElementById(t[e].placementDivId),Xe=(e,t)=>{var a;return(null===(a=t[e])||void 0===a?void 0:a.wrapperDivId)?document.getElementById(t[e].wrapperDivId):null},Ge=(e,t)=>document.getElementById(t[e].iframeId),Qe=({height:e,width:t,targetWidth:a})=>0===t||isNaN(e)||isNaN(t)||isNaN(a)?0:Math.round(a*e/t),Ze=(e,t)=>{e&&(e.style.height=W(t))},et="expanded-feedback-label",tt="expanded-safeframe",at="expandable-ads-styles",nt=(e,t)=>{const a=Ge(e,t),n=it(a);if(null===n||null===a)throw new Error(`feedbackWrapper: ${n?"present":"missing"}, safeFrame: ${a?"present":"missing"}`);n.classList.add(et),a.classList.add(tt)},it=e=>(null==e?void 0:e.parentElement).querySelector("div[id$=placement_Feedback]"),ot=(e,t)=>{const a=Ge(e,t),n=it(a);null!==n&&null!==a&&(n.classList.remove(et),a.classList.remove(tt))},st=(e,t)=>{((e,t)=>{if(null!==document.querySelector(`#${at}`))return;const a=document.createElement("style");a.id=at,a.innerHTML=`\n        div.${et} {\n            background-color: white;\n            z-index: 2;\n            height: 30px !important;\n            top: 0px !important;\n        }\n        iframe.${tt} {\n            display: block;\n            padding: 0px !important;\n            max-height: none !important;\n        }`;const n=Ke(e,t);if(null==n)throw new Error("Failed to append styles for expandable ads");n.appendChild(a)})(e,t)},rt=(e,t)=>(e.staticHeight?parseInt(e.staticHeight,10):0)+(O(e.width)?parseInt(e.height,10):Qe({height:parseInt(e.height,10),width:parseInt(e.width,10),targetWidth:t})),dt=(e,t,a)=>{const n=n=>{lt(n,e,t),a(e)};window.addEventListener("scroll",n,{once:!0}),window.addEventListener("click",n,{once:!0}),window.addEventListener("swipe",n,{once:!0}),window.addEventListener("tap",n,{once:!0})},lt=(e,t,a)=>{a.sendMessageToAd(t.options.arid,"triggerEventInIframe",{eventType:e.type})},ct=(e,t)=>{lt(new Event("click"),e,t)},mt=e=>e+"_Feedback";class pt{async addSponsoredLabelWithFeedbackLink(e,t){e.appendChildTo(this.parentHtmlId,this);const a=await t.getSponsoredLabelAndFeedbackLink(this.urlPathAndParameter);return(null==a?void 0:a.isOk())?(e.updateElement(this.getHtmlId(),a),Promise.resolve()):Promise.reject()}getHtmlId(){return mt(this.parentHtmlId)}isHidden(){return this.hidden}exists(e){return e.exists(this.getHtmlId())}constructor(e,t,a,n,i,o,s){this.parentHtmlId=e,this.feedbackStyle=t,this.labelText=a,this.labelStyle=n,this.position=i,this.urlPathAndParameter=o,this.hidden=s}}class ht{open(e){e.clickChildLink(this)}getHtmlId(){return mt(this.parentHtmlId)}constructor(e){this.parentHtmlId=e}}class ut{createSponsoredLabelWithFeedbackLink(e,t){e.exists(this.feedbackHtmlPort)||(t.request(),e.addSponsoredLabelWithFeedbackLink(this.feedbackHtmlPort,this.feedbackApiPort).then((()=>{t.success(),e.isHidden()||t.labelRenderedHost()})).catch((()=>{t.error()})))}openModal(e){e.open(this.feedbackHtmlPort)}labelRendered(e){e.labelRenderedCreative()}removeSponsoredLabelAndFeedbackLink(e){var t;try{null===(t=document.getElementById(mt(e)))||void 0===t||t.remove()}catch(a){M("Unable to remove AdFeedback Div",a)}}logTransparencyInfoMissing(e){e.transparencyInfoMissing()}constructor(e,t){this.feedbackHtmlPort=e,this.feedbackApiPort=t}}const wt=e=>new kt(e),ft="adfeedback_request",vt="adfeedback_success",gt="adfeedback_error",bt="adfeedback_sponsoredlabelrendered_creative",yt="adfeedback_sponsoredlabelrendered_host",St="adfeedback:request",It="adfeedback:success",At="adfeedback:error",Mt="adfeedback:sponsoredlabelrendered:creative",Dt="adfeedback:sponsoredlabelrendered:host",Et="adfeedback:sponsoredlabelrendered",Tt="adfeedback:transparencyinfo:missing";class kt{request(){g(St,this.placement),b(St),xe(ft,this.placement)}success(){g(It,this.placement),b(It),xe(vt,this.placement)}error(){g(At,this.placement),xe(gt,this.placement)}labelRenderedCreative(){g(Mt,this.placement),b(Et),xe(bt,this.placement)}labelRenderedHost(){g(Dt,this.placement),b(Et),xe(yt,this.placement)}transparencyInfoMissing(){g(Tt,this.placement),b(Tt)}constructor(e){this.placement=e}}class Pt{isOk(){return"ok"===this.status}constructor(e,t,a){this.status=e,this.html=t,this.script=a}}class _t{async getSponsoredLabelAndFeedbackLink(e){return fetch(this.windowRepo.origin()+e).then((async e=>{if(e.ok){const t=await e.json();return new Pt(t.status,t.html,t.script)}return Promise.reject(null)})).catch((()=>Promise.reject(null)))}constructor(e){this.windowRepo=e}}class Lt{appendChildTo(e,t){var a,n;function i(e){const t=document.createElement("div");return t.setAttribute("id",e.getHtmlId()),a(t,e.feedbackStyle),t.append(function(e){const t=document.createElement("div");return t.innerHTML=e.labelText,a(t,e.labelStyle),t}(e)),t;function a(e,t){for(const a in t)e.style.setProperty(a,t[a])}}1===t.position?null===(a=xt(e))||void 0===a||a.prepend(i(t)):0===t.position&&(null===(n=xt(e))||void 0===n||n.append(i(t)))}updateElement(e,t){const a=xt(e);a&&(a.innerHTML=t.html,function(e,t){const a=function(e){const t=document.createElement("script");return e.prepend(t),t}(e);a.innerHTML=t.script}(a,t))}clickChildLink(e){const t=document.getElementById(e.getHtmlId());var a;if(t)for(const n of t.children)if("A"===(a=n).tagName||"DIV"===a.tagName)return void n.click()}exists(e){return!!document.getElementById(e)}}const xt=e=>document.getElementById(e),Ft={code:"BE",hostname:"www.amazon.com.be",name:"Belgium"},Nt={code:"FR",hostname:"www.amazon.fr",name:"France"},Ct={code:"DE",hostname:"www.amazon.de",name:"Germany"},Rt={code:"IT",hostname:"www.amazon.it",name:"Italy"},zt={code:"NL",hostname:"www.amazon.nl",name:"Netherlands"},Ht={code:"PL",hostname:"www.amazon.pl",name:"Poland"},Wt={code:"ES",hostname:"www.amazon.es",name:"Spain"},Ot={code:"SE",hostname:"www.amazon.se",name:"Sweden"},$t=e=>location.hostname===e.hostname,Bt=e=>{return!($t(Ft)||$t(Nt)||$t(Ct)||$t(Rt)||$t(zt)||$t(Ht)||$t(Wt)||$t(Ot))||!jt(null===(n=null===(a=null===(t=null==e?void 0:e.url)||void 0===t?void 0:t.parameters)||void 0===a?void 0:a.adPlacementMetaData)||void 0===n?void 0:n.slotName)&&(null===(r=null===(s=null===(o=null===(i=null==e?void 0:e.url)||void 0===i?void 0:i.parameters)||void 0===o?void 0:o.adCreativeMetaData)||void 0===s?void 0:s.adCreativeDetails)||void 0===r?void 0:r.length)>0&&(null===(c=null===(l=null===(d=null==e?void 0:e.url)||void 0===d?void 0:d.parameters)||void 0===l?void 0:l.adCreativeMetaData)||void 0===c?void 0:c.adCreativeDetails.every((e=>function(e){var t,a,n;return e.version&&!jt(e.advertiserIdNS)&&void 0!==(null===(t=e.selectionSignals)||void 0===t?void 0:t.context)&&void 0!==(null===(a=e.selectionSignals)||void 0===a?void 0:a.location)&&!jt(null===(n=e.selectionSignals)||void 0===n?void 0:n.pastActivity)}(e))));var t,a,n,i,o,s,r,d,l,c},jt=e=>!e||e.length<=0,Vt=()=>new Ut(new ut(new Lt,new _t({origin:()=>window.location.origin})));class Ut{addSponsoredLabel({parentHtmlId:e,placement:t,feedback:a}){return Bt(a)?(a.hidden&&(Object.assign(a.style,{display:"none"}),Object.assign(a.label.style,{display:"none"})),this.feedbackService.createSponsoredLabelWithFeedbackLink(function(e,t){return new pt(e,t.style,t.label.text,t.label.style,"TOP"===t.position?1:0,qt(t.url.path,encodeURIComponent(JSON.stringify(t.url.parameters))),t.hidden)}(e,a),wt(t)),!0):(this.feedbackService.logTransparencyInfoMissing(wt(t)),M("Transparency Information missing"),!1)}openModal(e){this.feedbackService.openModal(new ht(e))}labelRendered({placement:e}){this.feedbackService.labelRendered(wt(e))}removeSponsoredLabelAndFeedbackLink(e){this.feedbackService.removeSponsoredLabelAndFeedbackLink(e)}constructor(e){this.feedbackService=e}}const qt=(e,t)=>e+"?pl="+t,Jt=e=>{Vt().labelRendered({placement:{id:e.options.placementId,name:e.options.placementName}})},Yt=e=>{Vt().openModal(e.options.adPlacementMetaData.adElementId)},Kt=e=>{Vt().removeSponsoredLabelAndFeedbackLink(e.options.adPlacementMetaData.adElementId)},Xt=e=>{return Vt().addSponsoredLabel({parentHtmlId:e.adPlacementMetaData.adElementId,placement:{id:e.placementId,name:e.placementName},feedback:{position:e.adFeedbackInfo.adFeedbackOnTop?"TOP":"BOTTOM",hidden:!e.adFeedbackInfo.boolFeedback,style:e.feedbackDivStyle,url:{path:e.adFeedbackInfo.endPoint,parameters:{adPlacementMetaData:e.adPlacementMetaData,adCreativeMetaData:e.adCreativeMetaData}},label:{text:(t=e.adFeedbackInfo.sponsoredText,i(t)),style:e.advertisementStyle}}});var t},Gt={};function Qt(e,t,a){var n;e&&e.id&&!Gt[e.id]&&(null===(n=window.P)||void 0===n||n.when("gw-video-orchestrator").execute((n=>{n.subscribe(e,t,a),Gt[e.id]=!0})))}let Zt=null;function ea(e,t,a){const n=t=>{a.sendCustomMessageToAd(e.options.arid,"videoAutoplayResponse",t)};var i;e.options.expParams&&e.options.expParams.noVideoAutoplay?n(!1):(i=e.options.pageType)&&"gateway"===i.toLowerCase()?Qt(e.iframe,n,t):Zt===e.options.arid?n(!0):null===Zt&&function(e){const t=document.getElementsByTagName("video");for(let a=0;a<t.length;++a)if(!t[a].paused&&le(e,t[a]))return!1;return!0}(e.iframe)?(Zt=e.options.arid,n(!0)):n(!1)}function ta(){var e;null===(e=window.P)||void 0===e||e.when("gw-video-orchestrator").execute((e=>{e.elect()})),Zt=null}function aa(e){var t,a;(t=e.iframe)&&(null===(a=window.P)||void 0===a||a.when("gw-video-orchestrator").execute((e=>{e.elect(t)}))),Zt=e.options.arid}const na=(e,t,a)=>{const n=(e,t)=>{var a,n;return null!==(n=null===(a=document.getElementById(e))||void 0===a?void 0:a.getAttribute(t))&&void 0!==n?n:null},i=n("ilmRelocatedHtml","data-relocated-html");i?e.sendMessageToAd(t,"sendRelocatedHtmlContentEncodedToAd",i):document.addEventListener("sendRelocatedHtmlContentEncodedToAd",(i=>{const o=n("ilmRelocatedHtml","data-relocated-html");o?e.sendMessageToAd(t,"sendRelocatedHtmlContentEncodedToAd",o):a()}),{once:!0})},ia=e=>{const t=document.getElementById(e);void 0!==t&&t&&(t.style.display="none")};var oa=function(e,t,a){sa()&&(ra(da(e,t.id,a)),ra(da(e,s(t.name),a)))},sa=function(){var e;return"function"==typeof(null===(e=null===window||void 0===window?void 0:window.ue)||void 0===e?void 0:e.tag)},ra=function(e){var t;return null===(t=null===window||void 0===window?void 0:window.ue)||void 0===t?void 0:t.tag(e)},da=function(e,t,a){return"".concat(e,":").concat(t).concat(la(a))},la=function(e){return e?":".concat(e):""};const ca=e=>{const t=document.getElementById("ape_"+e+"_userData"),a=null==t?void 0:t.getAttribute("data-user-data");return{rawCookies:document.cookie,aPageStart:window.aPageStart,adStartTime:(new Date).getTime(),userDataAttr:a}},ma=(e,t)=>{var a;const n=Object.assign({},e);return n.weblabTreatments=null!==(a=n.weblabTreatments)&&void 0!==a?a:null===window||void 0===window?void 0:window.renderingWeblabs,n.safeFrameSrc=t,n},pa="data-arid",ha=e=>document.getElementById(e),ua=(e,t)=>{var a,n;const i=`ape_${t.getAttribute("data-scope")}_iframe`,o=null!==(a=t.getAttribute("data-ad-details"))&&void 0!==a?a:null===(n=ha(i))||void 0===n?void 0:n.name,s=JSON.parse(o);if(!ha(i)){const a=document.getElementById(s.adUnitPlacementId);if(!e[s.arid]&&(null==a?void 0:a.innerHTML)){a.innerHTML="",t.removeAttribute(pa);const e=`ape_${V(s)}_text-wrapper`;document.getElementById(e)&&document.getElementById(e).remove()}}return s};class wa{constructor(t,a){this.hms=t,this.hc=a,this.changeSize=(e,t)=>{var a;if(!e.options.allowChangeSize||ba(e,t))return;const n=null===(a=e.options.allowedSizes)||void 0===a?void 0:a.concat(Sa(e.options.size));if(va(t,n)){e.iframe.style.height=t.height,e.iframe.style.width=t.width;const a=Xe(e.options.arid,this.hc.AD_IDS);e.placement.style.height=a?t.height:"auto",e.placement.style.width=t.width;const n=this.hc.ADS_HANDLERS[e.options.arid];ga(e),n.defaultResizeSafeFrameHandler&&window.removeEventListener("resize",n.defaultResizeSafeFrameHandler)}else M(`Size is not allow-listed: '${t.width}' x '${t.height}'`)},this.sendAdBarTrace=(e,t)=>{e.options.arid in this.hc.AD_TRACERS&&this.hc.AD_TRACERS[e.options.arid].logTrace(t.field,t.traceInfo)},this.startPixelTracking=async(e,t)=>{await Ne(this.hms,this.hc,e,t)},this.logAPIInvocation=(e,t)=>{const a=`messenger:${t.apiName}`;b(a),g(a,{id:e.options.placementId,name:e.options.placementName}),e.options.arid in this.hc.AD_TRACERS&&this.hc.AD_TRACERS[e.options.arid].logTrace("apiCalls",t)},this.resizeSafeFrameAd=async e=>{window.addEventListener("resize",this.hc.ADS_HANDLERS[e.options.arid].defaultResizeSafeFrameHandler),qe(e.options.arid,e.options.size.width,e.options.size.height,e.options.maxAdWidth,this.hms,this.hc.AD_IDS)},this.setResizePlacementStyle=async e=>{window.addEventListener("resize",this.hc.ADS_HANDLERS[e.options.arid].defaultSetResizePlacementStyle),e.options.resizePlacementStyle&&Je(e.options.arid,this.hc.AD_IDS,e.options.resizePlacementStyle)},this.logError=(e,t)=>{M(t.message+": "+e.options.placementName,t.error)},this.logCsaEvent=(e,t)=>{xe(t.metricName,{name:e.options.placementName,id:e.options.placementId})},this.addCsaEntity=(e,t)=>{Le(t)},this.sendLatencyMetric=(e,t)=>fa(e,t),this.customMessage=(e,t)=>{this.hms.customMessage(t.key,t.body,["openPsAdPopover","openATCModal","setPartner","sendMetrics","wrap"],e.options.placementName,e.options.placementId)},this.fireViewableLatencyMetrics=async(e,t)=>{Pe(e.options.arid,e.options.placementName,e.options.placementId,e.options.adUnitPlacementId,t.adLoadedTimestamp)},this.countMetric=(e,t)=>{t.isGlobal?b(t.metricMsg,t.value):g(t.metricMsg,{id:e.options.placementId,name:e.options.placementName},t.value)},this.addCsmTag=(e,t)=>{var a,n;t.isGlobal?(a=t.tag,n=t.msg,sa()&&ra(a+la(n))):oa(t.tag,{id:e.options.placementId,name:e.options.placementName},t.msg)},this.requestVideoAutoplay=async(e,t)=>{ea(e,t,this.hms)},this.releaseVideoAutoplay=async()=>{ta()},this.haveVideoAutoplayPermission=async e=>{aa(e)},this.feedbackLabelRendered=e=>{Jt(e)},this.feedbackOpenModal=e=>{Yt(e)},this.handleFallbackExperience=async e=>{Kt(e)},this.expandAdSlot=(e,t)=>{const a=e.iframe;try{const n=rt(t,a.offsetWidth),i=O(t.width)?t.width:a.offsetWidth;st(e.options.arid,this.hc.AD_IDS),qe(e.options.arid,W(i),W(n),e.options.maxAdWidth,this.hms,this.hc.AD_IDS);const o=Xe(e.options.arid,this.hc.AD_IDS);Ze(o,W(n+20)),dt(e,this.hms,this.resetSlotSize)}catch(n){D("Error attempting to expand ad slot: ",n),ct(e,this.hms),this.resetSlotSize(e)}},this.expandAdSlotWithOverlap=(e,t)=>{const a=e.iframe;try{const n=rt(t,a.offsetWidth);st(e.options.arid,this.hc.AD_IDS),Ye(e.options.arid,this.hc.AD_IDS,W(n)),nt(e.options.arid,this.hc.AD_IDS),dt(e,this.hms,this.resetSlotSize)}catch(n){D("Error attempting to expand ad slot with overlap: ",n),ct(e,this.hms),this.resetSlotSize(e)}},this.resetSlotSize=e=>{const t=this.hc.ADS_HANDLERS[e.options.arid].defaultResizeSafeFrameHandler;t(),window.addEventListener("resize",N(20,t)),Ze(Xe(e.options.arid,this.hc.AD_IDS),W(parseInt(e.options.size.height,10)+20)),ot(e.options.arid,this.hc.AD_IDS)},this.triggerEventInIframe=(e,t)=>{this.hms.sendMessageToAd(e.options.arid,"triggerEventInIframe",{eventType:t.event.type})},this.registerCODFallback=(t,a)=>{e(fe)("localStorage")&&H("SF",t.options.arid,a)},this.clearCODFallback=t=>{var a,n;e(fe)("localStorage")&&(a="SF",n=t.options.arid,localStorage.removeItem(R(a,n)))},this.safeFrameReady=e=>{var t,a;null===(t=null===performance||void 0===performance?void 0:performance.mark)||void 0===t||t.call(performance,`SafeFrame:  safeFrameReady ${e.options.slotName}`),(null===(a=e.options.expParams)||void 0===a?void 0:a.ilmRelocatedHtmlIsActive)&&!e.options.htmlContentEncoded&&na(this.hms,e.options.arid,(()=>{ia(this.hc.AD_IDS[e.options.arid].placementDivId)})),this.hms.sendMessageToAd(e.options.arid,"setupComputedAdDetails",{computed:ca(e.options.placementName)})},this.saveAdDetailsForAdReporter=(e,t)=>{var a;window.adReporterDetails=null!==(a=window.adReporterDetails)&&void 0!==a?a:{},window.adReporterDetails[e.options.adUnitPlacementId]=Object.assign(e.options,t)}}}const fa=(e,{latencyMetricType:t,timestamp:a})=>{x().sendLatencyMetric({latencyMetricType:t,placementName:e.options.placementName,placementId:e.options.placementId,placementDivId:e.options.adUnitPlacementId,timestamp:a})},va=(e,t)=>0!==t.length&&t.some((t=>{return n=t,(a=e).height===n.height&&a.width===n.width;var a,n})),ga=e=>{e.placement.style.overflow=""},ba=(e,t)=>e.placement.style.height===t.height&&e.placement.style.width===t.width,ya=e=>(null==e?void 0:e.endsWith("px"))||(null==e?void 0:e.endsWith("%"))?e:`${e}px`,Sa=e=>({height:ya(e.height),width:ya(e.width)});class Ia extends wa{constructor(e,t){super(e,t),this.collapseSlot=async e=>{var t;ia(this.hc.AD_IDS[e.options.arid].placementDivId),ia(this.hc.AD_IDS[e.options.arid].auiCardDeckId),"nav-sitewide-msg"===e.options.slotName&&(await Ee("amznJQ.available:navbarJSLoaded",e.placement),"function"==typeof(null===(t=null===parent||void 0===parent?void 0:parent.navbar)||void 0===t?void 0:t.unHideSWM)&&parent.navbar.unHideSWM())}}}const Aa="adload:start",Ma="adload:delayloadcallback",Da="adload:iframecreated",Ea="adload_delayload",Ta="adload_iframecreated",ka={1:"abpstatus:enabled",0:"abpstatus:notenabled","-1":"abpstatus:unknown"},Pa=new Map([["1","abpstatus_enabled"],["0","abpstatus_notenabled"],["-1","abpstatus_unknown"]]);class _a{collapse(){this.div.style.display="none"}constructor(e,t,a){this.id=e,this.name=t,this.div=a}}const La=(e,t)=>new _a(t.placementId,t.placementName,e),xa="div#ape_Detail_desktop-detail-ilm_desktop_placement",Fa="nav-ewc-persistent-hover",Na=e=>{"desktop-detail-ilm"===e.slotName&&new B(window,"ADPT_SF_ILM_EWC_764130").isT1()&&Ra()},Ca=e=>"attributes"===e.type&&"class"===e.attributeName&&e.target.classList.contains(Fa),Ra=()=>{if(null!==document.querySelector(`.${Fa}`))return void za(xa);new MutationObserver(((e,t)=>{if(e.some(Ca))try{za(xa),t.disconnect()}catch(a){M("Failed to resize ILM for EWC.",a)}})).observe(window.document.documentElement,{attributes:!0,attributeFilter:["class"]})},za=e=>{const t=document.querySelector("div#nav-flyout-ewc"),a=document.querySelector(e);if(null===a||null===t)return void M(`could not find placementDiv (value was: ${a}) or ewc (value was: ${t})`);const n=t.offsetWidth;Ha(a,n)},Ha=(e,t)=>{var a;const n=document.createElement("style");n.innerHTML=`@media screen and (min-width: 1500px) { div[id$=${e.id}] {\n        width: calc(100vw - ${t}px) !important; \n        margin-left: calc(-50vw + 50% + ${t/2}px) !important;\n        margin-right: calc(-50vw + 50% + ${t/2}px) !important;\n    `,null===(a=null===document||void 0===document?void 0:document.body)||void 0===a||a.appendChild(n)};class Wa{start(){const e=()=>{this.sendTrace(),window.setInterval(this.sendTrace,3e3)};"loading"!==document.readyState?e():window.addEventListener("load",e)}logTrace(e,t){if(this.traceId){let a;const n=(new Date).getTime();Object.prototype.hasOwnProperty.call(this.storedTrace,e)||(this.storedTrace[e]=[]);a=t===Object(t)?Object.assign({},t):JSON.parse('{ "'+e+'":"'+t+'"}'),a.timeStamp=n,a.timeSinceAdStart=n-this.adStartTime,this.storedTrace[e].push(a)}}async sendTrace(){if(!(e=>{for(const t in e)if(Object.prototype.hasOwnProperty.call(this.storedTrace,t))return!1;return!0})(this.storedTrace)){const e="/gp/adbarplus?traceId="+this.traceId+"&systemName=browser",t=await fetch(e,{method:"POST",body:JSON.stringify(this.storedTrace),headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(t.ok)for(const a in this.storedTrace)Object.prototype.hasOwnProperty.call(this.storedTrace,a)&&delete this.storedTrace[a];else console.error("failed to send request to /gp/adbarplus",t)}}constructor(e,t=0,a={}){this.traceId=e,this.adStartTime=t,this.storedTrace=a}}const Oa=(e,t)=>{const{slotName:a,traceId:n,arid:i,allowedSizes:o,computed:s,safeFrameSrc:r,abpStatus:d,loadAfter:l}=t,c=window[a],m=new Wa(n,c&&c.adStartTime||0);e.AD_TRACERS[i]=m,e.AD_TRACERS[i].logTrace("safeFrameInput",t);const p={caches:window.caches,plugins:document.plugins,cookies:document.cookie,userAgents:navigator.userAgent};e.AD_TRACERS[i].logTrace("browserData",p);const h={allowedSizes:o,computed:s,adStartTime:c,safeFrameSrc:r,abpStatus:d,loadAfter:l};e.AD_TRACERS[i].logTrace("additionalInitilizationParams",h),m.start()},$a=["ape_events_320x50-mobile-wrapper_mweb_placement","ape_events_320x50-mobile-wrapper_mshop_placement"],Ba=(e,t)=>{const a=ja(e);return(null==a?void 0:a.getAttribute(pa))===t.arid},ja=({placementDivId:e,wrapperDivId:t})=>{const a=document.getElementById(t);return a||document.getElementById(e)},Va=(e,t,a,n,i)=>{n.contentWindow.postMessage(i,"*",[i]),e.sendMessageToAd(t.arid,"adDetails",t)},Ua=(e,t,a,n)=>{var i,o;try{const s=document.getElementById(a.AD_IDS[t.arid].placementDivId),r=a.AD_IDS[t.arid].iframeId,d=ha(r),l=d||q(t,r,t.safeFrameSrc),c=new MessageChannel;a.adMap[t.arid]={placement:s,iframe:l,options:t,messagePort:null!=n?n:c.port1,hasTransferredMessagePort:!1},null===(i=null===performance||void 0===performance?void 0:performance.mark)||void 0===i||i.call(performance,`SafeFrame: Start check ad load ${t.arid} for ${s.id}`),((e,t)=>"true"===e.adMap[t].iframe.getAttribute("data-iframe-ready"))(a,t.arid)&&!n?(null===(o=null===performance||void 0===performance?void 0:performance.mark)||void 0===o||o.call(performance,"SafeFrame: Start fast transfer"),Va(e,t,0,l,c.port2)):l.addEventListener("load",(()=>{var n;a.adMap[t.arid].hasTransferredMessagePort||(null===(n=null===performance||void 0===performance?void 0:performance.mark)||void 0===n||n.call(performance,"SafeFrame: Start transfer"),Va(e,t,0,l,c.port2),a.adMap[t.arid].hasTransferredMessagePort=!0)})),d||s.appendChild(l)}catch(s){M(`Error creating safeFrame ${t.slotName}`,s)}},qa=e=>null!==e.closest('div.hidden[id^="hidden-slot-"]'),Ja=e=>null!==e.closest('div[id="slots-container"]'),Ya=CSS.escape("text/x-dacx-safeframe");class Ka{constructor(e,t,a,n,i){this.btr=e,this.hc=t,this.hms=a,this.hmr=n,this.supportedCommands=i,this.initializeAdIds=e=>{var t,a,n;this.hc.AD_IDS[e.arid]=(a=(t=e).placementName,n=V(t),{slotId:a,wrapperDivId:`ape_${n}_wrapper`,placementDivId:`ape_${n}_placement`,iframeId:`ape_${n}_iframe`,textDivWrapperId:`ape_${n}_text-wrapper`,textDivId:`ape_${n}_text`,auiCardDeckId:`ape_${n}_aui_cardDeck`})},this.initAllSafeFrames=async()=>{var e;null===(e=null===performance||void 0===performance?void 0:performance.mark)||void 0===e||e.call(performance,"SafeFrame: Start initAllSafeFrames"),this.getWindowSafeFrame()?nn()&&await this.getWindowSafeFrame().loadAds():(this.initWindowSafeFrame({registerCustomMessageListener:this.hms.registerCustomMessageListener,sendCustomMessage:this.hms.sendCustomMessage,loadAds:this.loadAds,loadAd:this.loadAd,secondPhaseLoadAd:this.secondPhaseLoadAd}),je(),nn()&&await this.loadAds(),tn(this.getWindowSafeFrame()))},this.loadAd=async e=>{var t;const a=this.hc;null===performance||void 0===performance||performance.mark(`SafeFrame: Start loadAd ${e.id}`);try{const n=ua(this.hms.adMap,e),i=e.getAttribute(pa),o=e.id.endsWith("_wrapper")?null===(t=e.children[0])||void 0===t?void 0:t.id:e.id;if($a.includes(o.toLocaleLowerCase())&&qa(e)){const t=document.getElementById("slots-container"),a={childList:!0,subtree:!0};return void new MutationObserver(((t,a)=>{qa(e)||(Ja(e)?(e.style.width=document.body.offsetWidth+"px",window.MAsf.loadAd(e)):e.removeAttribute(pa))})).observe(t,a)}if(i)return;const s=this.getSafeFramePath(n),r=ma(n,s);Oa(a,r),e.setAttribute(pa,r.arid),Ga(this.hc,this.hms,r),this.initializeAdIds(r);const d=La(e,n);if(r.forcePunt)return oa("forcePunt",d),Le({forcePunt:"true"}),void d.collapse();Xa(r),an(r),De(r.loadAfter)||await Ee(r.loadAfter,e),Za(d,a,r,this.hmr,this.hms)}catch(n){M(`Error parsing tag ${e.id}`,n)}},this.loadAds=async()=>{var e;null===(e=null===performance||void 0===performance?void 0:performance.mark)||void 0===e||e.call(performance,"SafeFrame: Start loadAds");const t=[],a=document.querySelectorAll(`div .${Ya}`);for(const n of a)t.push(this.loadAd(n));await Promise.all(t)},this.secondPhaseLoadAd=(e,t,a)=>{this.initializeAdIds(t),Ua(this.hms,t,this.hc,a);const n=this.hc,i=this.hms,o=this.hc.adMap[e].options;Oa(n,o),Ga(n,i,o);const s=La(document.getElementById(this.hc.AD_IDS[e].placementDivId),o);if(o.forcePunt)return oa("forcePunt",s),Le({forcePunt:"true"}),void s.collapse();Xa(o),an(o),g(Ma,s),xe(Ea,s),Xt(o)?(Qa(s,n,o,this.hmr,this.hms),en(n,o,i)):s.collapse()}}}const Xa=e=>{x().sendLatencyMetric({latencyMetricType:Se,placementId:e.placementId,placementName:e.placementName,placementDivId:e.adUnitPlacementId}),g(Aa,{id:e.placementId,name:e.placementName}),b(Aa),xe("adload_start",{id:e.placementId,name:e.placementName})},Ga=(e,t,a)=>{e.ADS_HANDLERS[a.arid]=e.ADS_HANDLERS[a.arid]||{},e.ADS_HANDLERS[a.arid].defaultResizeSafeFrameHandler=((e,t,a)=>async()=>{qe(a.arid,a.size.width,a.size.height,a.maxAdWidth,e,t.AD_IDS)})(t,e,a),e.ADS_HANDLERS[a.arid].defaultSetResizePlacementStyle=((e,t)=>async()=>{t.resizePlacementStyle&&Je(t.arid,e.AD_IDS,t.resizePlacementStyle)})(e,a)},Qa=(e,t,a,n,i)=>{if(g(Ma,{id:a.placementId,name:a.placementName}),xe(Ea,{id:a.placementId,name:a.placementName}),a.forcePunt)return oa("forcePunt",{id:a.placementId,name:a.placementName}),Le({forcePunt:"true"}),void e.collapse();t.adMap[a.arid].messagePort.onmessage=n.receiveMessage,Xt(a)?en(t,a,i):e.collapse()},Za=(e,t,a,n,i)=>{var o;(g(Ma,{id:a.placementId,name:a.placementName}),xe(Ea,{id:a.placementId,name:a.placementName}),!Ba(t.AD_IDS[a.arid],a)||(Ua(i,a,t),o=a,x().sendLatencyMetric({latencyMetricType:Ie,placementId:o.placementId,placementName:o.placementName,placementDivId:o.adUnitPlacementId}),g(Da,{id:o.placementId,name:o.placementName}),xe(Ta,{id:o.placementId,name:o.placementName}),t.adMap[a.arid].messagePort.onmessage=n.receiveMessage,Xt(a)))?en(t,a,i):e.collapse()},en=(e,t,a)=>{Na(t)},tn=e=>{window.addEventListener("resize",(()=>{null==e||e.sendCustomMessage("resize",{height:window.innerHeight,width:window.innerWidth})}))},an=e=>{if(e.abpStatus){oa("ABPStatus"+n[e.abpStatus],{id:e.placementId,name:e.placementName}),Le({ABPStatus:n[e.abpStatus]});for(const t in n)g(ka[t],{id:e.placementId,name:e.placementName},e.abpStatus===t?1:0),e.abpStatus===t&&xe(Pa.get(t),{id:e.placementId,name:e.placementName})}},nn=()=>{var e,t;return!0!==(null===(t=null===(e=null===window||void 0===window?void 0:window.grandprix)||void 0===e?void 0:e.wrappers)||void 0===t?void 0:t.disableAutoload)},on=()=>{const e=window.location.hostname.split(".").pop();let t="na";return/^(com|ca|mx|br)$/.test(e)?t="na":/^(uk|de|fr|it|es|in|ae|sa|nl|tr|se|pl|eg|be)$/.test(e)?t="eu":/^(jp|au|sg)$/.test(e)?t="fe":/^(cn)$/.test(e)&&(t="cn"),"https://images-"+t+".ssl-images-amazon.com"},sn="custommessage:notallowlisted";class rn{constructor(e,t={}){this.adMap=e,this.msgListeners=t,this.sendMessageToAd=(e,t,a)=>{const n={command:t,data:a};this.adMap[e].messagePort.postMessage(n)},this.customMessage=(e,t,a,n,i)=>{const o=this.msgListeners;try{"undefined"!==a&&Array.isArray(a)&&(a.indexOf(e)>-1&&o[e]?(b(`custommessage:allowlisted:${e}`),o[e](t)):-1===a.indexOf(e)?(b(sn),g(sn,{id:i,name:n})):M("Unrecognized custom message key: "+e))}catch(s){M("Custom Message Error",s)}},this.registerCustomMessageListener=(e,t,a)=>{let n=!1;const i=this.msgListeners;try{if(!i[e]||"function"!=typeof i[e]||a)i[e]=t,n=!0;else{const t=new Error("Custom message listener already exists for key: "+e);M("Duplicate Key",t)}}catch(o){M("Error registering custom message listener",o)}return n},this.sendCustomMessage=(e,t)=>{const a=this.adMap,n={key:e,data:t};for(const i in a)this.sendMessageToAd(i,"customMessage",n)},this.sendCustomMessageToAd=(e,t,a)=>{const n={key:t,data:a};this.sendMessageToAd(e,"customMessage",n)}}}class dn{constructor(e={},t={},a={},n={}){this.adMap=e,this.ADS_HANDLERS=t,this.AD_IDS=a,this.AD_TRACERS=n}}class ln{constructor(e={},t){this.adMap=e,this.supportedCommands=t,this.receiveMessage=async e=>{const t=this.adMap,a=e.data,n=t[a.arid];try{const e=this.supportedCommands[a.command];e&&(await cn(),await e(n,a.data))}catch(i){const t="Problem with message: "+JSON.stringify(e.data);M(t,i)}}}}const cn=async()=>new Promise((e=>setTimeout(e,0)));var mn;null===(mn=null===performance||void 0===performance?void 0:performance.mark)||void 0===mn||mn.call(performance,"SafeFrame: SafeFrame: Starting DAsf");const pn=new dn,hn=new rn(null==pn?void 0:pn.adMap),un=new class extends Ka{constructor(e,t=new dn,n=new rn(t.adMap)){const i=new Ia(n,t);super(e,t,n,new ln(t.adMap,i),i),this.getSafeFramePath=e=>{const t=on(),n=e.abpAcceptable&&("1"===e.abpStatus||"-1"===e.abpStatus);let i;if(o=e.mediaType,s=e.adCreativeMetaData.adProgramId,(e=>"V"===e)(o)&&!a.hasOwnProperty(s)){const e=t+this.btr.safeFrameVideoPath,a=t+this.btr.allowlistedSafeFrameVideoPath;i=n?a:e}else{const e=t+this.btr.safeFramePath,a=t+this.btr.allowlistedSafeFramePath;i=n?a:e}var o,s;return i},this.initWindowSafeFrame=e=>{window.DAsf=e},this.getWindowSafeFrame=()=>window.DAsf}}({safeFrameVideoPath:"/images/S/apesafeframe/ape/sf/desktop/sfVideo-1.50.2ce07e89.html",allowlistedSafeFrameVideoPath:"/images/S/apesafeframe/ape/sf/whitelisted/desktop/sfVideo-1.50.2ce07e89.html",safeFramePath:"/images/S/apesafeframe/ape/sf/desktop/sf-1.50.547193bd.html",allowlistedSafeFramePath:"/images/S/apesafeframe/ape/sf/whitelisted/desktop/sf-1.50.547193bd.html"},pn,hn);t((()=>un.initAllSafeFrames()),M,"Error initializing safeFrame")()})();
//# sourceMappingURL=DAsf-1.50.5b68e360.js.map
